<mat-toolbar color="primary" class="header">
  <div class="container">
    <div class="header-content">
      <!-- Logo -->
      <div class="logo">
        <a routerLink="/" class="logo-link">
          <mat-icon>storefront</mat-icon>
          <span class="logo-text">CoreKit Store</span>
        </a>
      </div>

      <!-- Navigation -->
      <nav class="nav">
        <a
          mat-button
          routerLink="/"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{exact: true}"
        >
          Inicio
        </a>
        <a
          mat-button
          routerLink="/products"
          routerLinkActive="active"
        >
          Productos
        </a>
      </nav>

      <!-- User Menu / Login -->
      <div class="user-menu">
        <!-- Usuario autenticado -->
        <div *ngIf="isAuthenticated()" class="user-info">
          <button mat-button [matMenuTriggerFor]="userMenu" class="user-button">
            <mat-icon>account_circle</mat-icon>
            <span class="user-name">{{ currentUser()?.firstName || 'Usuario' }}</span>
            <mat-icon>arrow_drop_down</mat-icon>
          </button>

          <mat-menu #userMenu="matMenu">
            <div class="user-menu-header">
              <div class="user-details">
                <strong>{{ currentUser()?.firstName }} {{ currentUser()?.lastName }}</strong>
                <small>{{ currentUser()?.email }}</small>
              </div>
            </div>
            <mat-divider></mat-divider>
            <button mat-menu-item (click)="logout()">
              <mat-icon>logout</mat-icon>
              <span>Cerrar Sesión</span>
            </button>
          </mat-menu>
        </div>

        <!-- Usuario no autenticado -->
        <a
          *ngIf="!isAuthenticated()"
          mat-button
          routerLink="/login"
          class="login-button"
        >
          <mat-icon>login</mat-icon>
          <span>Iniciar Sesión</span>
        </a>
      </div>

      <!-- Cart -->
      <div class="cart">
        <a
          mat-button
          routerLink="/cart"
          routerLinkActive="active"
          class="cart-button"
        >
          <mat-icon
            [matBadge]="cartItemsCount > 0 ? cartItemsCount : null"
            matBadgeColor="accent"
            matBadgeSize="small"
            aria-hidden="false"
          >
            shopping_cart
          </mat-icon>
          <span class="cart-text">Carrito</span>
        </a>
      </div>
    </div>
  </div>
</mat-toolbar>
