<div class="product-list-container">
  <div class="header">
    <h1>Catálogo de Productos</h1>
    <p class="subtitle" *ngIf="!loading">
      {{ totalCount }} productos encontrados
    </p>
  </div>

  <!-- Filtros y búsqueda -->
  <div class="filters-section">
    <div class="container">
      <div class="search-filters">
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Buscar productos</mat-label>
          <input matInput [formControl]="searchControl">
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline" class="category-field">
          <mat-label>Categoría</mat-label>
          <mat-select [formControl]="categoryControl">
            <mat-option value="">Todas las categorías</mat-option>
            <mat-option *ngFor="let category of categories; trackBy: trackByCategoryId" [value]="category.id">
              {{ category.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <button mat-stroked-button (click)="clearFilters()" class="clear-filters-btn">
          <mat-icon>clear</mat-icon>
          Limpiar filtros
        </button>
      </div>
    </div>
  </div>

  <!-- Estado de carga -->
  <div class="loading-container" *ngIf="loading">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Cargando productos...</p>
  </div>

  <!-- Error -->
  <div class="error-container" *ngIf="error && !loading">
    <mat-icon color="warn">error</mat-icon>
    <p>{{ error }}</p>
    <button mat-raised-button color="primary" (click)="loadProducts()">
      Reintentar
    </button>
  </div>

  <!-- Lista de productos -->
  <div class="products-content" *ngIf="!loading && !error">
    <div class="container">
      <div class="products-grid" *ngIf="products.length > 0">
        <app-product-card
          *ngFor="let product of products; trackBy: trackByProductId"
          [product]="product">
        </app-product-card>
      </div>

      <!-- Sin resultados -->
      <div class="no-results" *ngIf="products.length === 0">
        <mat-icon>search_off</mat-icon>
        <h3>No se encontraron productos</h3>
        <p>Intenta ajustar los filtros de búsqueda</p>
        <button mat-raised-button color="primary" (click)="clearFilters()">
          Ver todos los productos
        </button>
      </div>

      <!-- Paginación -->
      <mat-paginator
        *ngIf="products.length > 0 && isClient"
        [length]="totalCount"
        [pageSize]="pageSize"
        [pageIndex]="currentPage - 1"
        [pageSizeOptions]="pageSizeOptions"
        [showFirstLastButtons]="true"
        (page)="onPageChange($event)"
        class="paginator">
      </mat-paginator>
    </div>
  </div>
</div>
